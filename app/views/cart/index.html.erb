<html lang="it">
<head>
  <title>CartOnRails</title>
  <%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track' => true %>
  <!-- Bootstrap -->
  <%= stylesheet_link_tag "bootstrap", :media => "all" %>
  <%= stylesheet_link_tag "bootstrap-responsive", :media => "all" %>
  <!-- -->
  <%= javascript_include_tag 'application', 'data-turbolinks-track' => true %>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>

    <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
        <div class="container-fluid">

            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand">Cart on Rails</a>
            </div>

            <div class="collapse navbar-collapse" >
                <ul class="nav navbar-nav">
                    <li><a href="/catalog">Guarda i prodotti</a></li>
                    <% if @_current_user %> 
                    <li class="active"><a href="/cart">Guarda il carrello</a></li>
                    <li><a href="/orders">Guarda gli ordini</a></li>
                    <% else %>
                    <li><a href="/login">Login</a></li>
                    <% end %>
                </ul>

                <ul class="nav navbar-nav navbar-right">
                    <% if @_current_user %>
                    <li><a href="/logout">Ciao <%= @_current_user.nickname %>.(Logout)</a></li>
                    <% else %>
                    <li class="navbar-text">Ciao Anonimo.</li>
                    <% end %>
                </ul>
            </div>
        </div>
    </nav>

<div class="container">

<h1>Cart</h1>

<p id="alert"><%= alert %></p>
<p id="notice"><%= notice %></p>


<table class="table">
  <thead>
    <tr>
      <th>Product</th>
      <th>Price</th>
      <th>Quantity</th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @cartItems.each do |item| %>
      <tr>
        <td><%= link_to item.product.name, showProduct_path(item.product) %></td>
        <td><%= number_to_currency(item.product.price) %></td>
        <td><%= item.quantity %></td>
        <td>
          <div class="btn-group">
          <%= link_to 'Add 1 to quantity', addItemToCart_path(item.product), :class => "btn btn-default" do%>
          <span class="glyphicon glyphicon-plus-sign"></span> 
          <% end %>
          <%= link_to 'Remove 1 to quantity', subItemToCart_path(item.product), :class => "btn btn-default"  do%>
          <span class="glyphicon glyphicon-minus-sign"></span>
          <% end %> 
          <%= link_to 'Remove this product', emptyCart_path, :class => "btn btn-default"  do%>          
          <span class="glyphicon glyphicon-remove-circle"></span>
          <% end %>
          </td>
          <div>
      </tr>
    <% end %>
    <% if @cartItems.empty? %>
      <tr>
        <td colspan="4">
          Nessun prodotto nel carrello
        </td>
      </tr>
    <% end %>
  </tbody>
</table>

<% unless @cartItems.empty? %>
<%= link_to 'Checkout', checkoutCart_path, :class => "btn btn-default" %>
<% end %>
</div>
</body>
</html>